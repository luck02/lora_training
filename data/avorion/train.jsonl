{"instruction": "How do I create a custom sector template in Avorion that spawns ancient gates with no regular gates and has a chance of pirate attacks?", "output": "package.path = package.path .. \";data/scripts/lib/?.lua\"\npackage.path = package.path .. \";data/scripts/?.lua\"\n\nlocal SectorGenerator = include (\"SectorGenerator\")\nlocal Placer = include(\"placer\")\ninclude(\"music\")\n\nlocal SectorTemplate = {}\n\n-- must be defined, will be used to get the probability of this sector\nfunction SectorTemplate.getProbabilityWeight(x, y)\n    return 5\nend\n\nfunction SectorTemplate.offgrid(x, y)\n    return true\nend\n\n-- this function returns whether or not a sector should have space gates\nfunction SectorTemplate.gates(x, y)\n    return false\nend\n\nfunction SectorTemplate.ancientGates(x, y, serverSeed)\n    return true\nend\n\n-- this function returns what relevant contents there will be in the sector (exact)\nfunction SectorTemplate.contents(x, y)\n    local seed = Seed(string.join({GameSeed(), x, y, \"ancientgates\"}, \"-\"))\n    math.randomseed(seed);\n\n    local random = random()\n\n    local contents = {ships = 0, stations = 0, seed = tostring(seed)}\n\n    return contents, random\nend\n\nfunction SectorTemplate.musicTracks()\n    local good = {\n        primary = TrackCollection.Desolate(),\n        secondary = combine(TrackCollection.Neutral()),\n    }\n\n    local neutral = {\n        primary = TrackCollection.Desolate(),\n        secondary = TrackCollection.All(),\n    }\n\n    local bad = {\n        primary = combine(TrackCollection.Middle(), TrackCollection.Desolate()),\n        secondary = combine(TrackCollection.Neutral(), TrackCollection.Desolate()),\n    }\n\n    return good, neutral, bad\nend\n\n-- player is the player who triggered the creation of the sector (only set in start sector, otherwise nil)\nfunction SectorTemplate.generate(player, seed, x, y)\n    local contents, random = SectorTemplate.contents(x, y)\n\n    local generator = SectorGenerator(x, y)\n\n    generator:createAncientGates()\n\n    Sector():addScriptOnce(\"data/scripts/sector/eventscheduler.lua\", \"events/pirateattack.lua\")\n\n    generator:addAmbientEvents()\n    Placer.resolveIntersections()\nend\n\nreturn SectorTemplate", "domain": "avorion", "metadata": {"context": "server", "avorion_apis": ["Sector", "SectorGenerator", "Placer", "Seed", "GameSeed"], "difficulty": "advanced"}}
{"instruction": "How do I create a sector template for a small asteroid field in Avorion that spawns off-grid with varying numbers of resource asteroids, claimable asteroids, and no gates?", "output": "package.path = package.path .. \";data/scripts/lib/?.lua\"\npackage.path = package.path .. \";data/scripts/?.lua\"\n\nlocal OperationExodus = include (\"story/operationexodus\")\nlocal SectorGenerator = include (\"SectorGenerator\")\nlocal Placer = include(\"placer\")\ninclude(\"music\")\n\nlocal SectorTemplate = {}\n\n-- must be defined, will be used to get the probability of this sector\nfunction SectorTemplate.getProbabilityWeight(x, y, seed, factionIndex, innerArea)\n    if factionIndex then\n        if innerArea then\n            return 250\n        else\n            return 200\n        end\n    else\n        return 250\n    end\nend\n\nfunction SectorTemplate.offgrid(x, y)\n    return true\nend\n\n-- this function returns whether or not a sector should have space gates\nfunction SectorTemplate.gates(x, y)\n    return false\nend\n\nfunction SectorTemplate.contents(x, y)\n    local seed = Seed(string.join({GameSeed(), x, y, \"smallasteroidfield\"}, \"-\"))\n    math.randomseed(seed)\n\n    local random = random()\n\n    local contents = {ships = 0, stations = 0, seed = tostring(seed)}\n    contents.resourceAsteroids = random:getInt(0, 2)\n    local maximum = random:getInt(0, 1)\n    contents.claimableAsteroids = random:multitest(maximum, 0.33)\n\n    local generator = SectorGenerator(x, y)\n    contents.asteroidEstimation = generator:estimateAsteroidNumbers(2.5 + contents.resourceAsteroids + contents.claimableAsteroids, 5)\n\n    return contents, random\nend\n\nfunction SectorTemplate.musicTracks()\n    local good = {\n        primary = combine(TrackCollection.Neutral(), TrackCollection.Desolate()),\n        secondary = combine(TrackCollection.Happy(), TrackCollection.Neutral()),\n    }\n\n    local neutral = {\n        primary = combine(TrackCollection.Neutral(), TrackCollection.Desolate()),\n        secondary = TrackCollection.All(),\n    }\n\n    local bad = {\n        primary = combine(TrackCollection.Middle(), TrackCollection.Desolate()),\n        secondary = TrackCollection.Neutral(),\n    }\n\n    return good, neutral, bad\nend\n\n-- player is the player who triggered the creation of the sector (only set in start sector, otherwise nil)\nfunction SectorTemplate.generate(player, seed, x, y)\n    local contents, random = SectorTemplate.contents(x, y)\n\n    local generator = SectorGenerator(x, y)\n\n    -- create filled asteroids\n    local numFields = random:getInt(0, 2)\n\n    for i = 1, numFields do\n        generator:createAsteroidField(0.1);\n    end\n\n    for i = 1, contents.resourceAsteroids do\n        local position = generator:createAsteroidField()\n        generator:createBigAsteroid(position)\n    end\n\n    local numSmallFields = random:getInt(1, 5)\n    for i = 1, numSmallFields do\n        generator:createSmallAsteroidField()\n    end\n\n    -- create empty asteroids\n    local numFields = random:getInt(1, 2)\n\n    for i = 1, numFields do\n        generator:createEmptyAsteroidField();\n    end\n\n    local numAsteroids = random:getInt(1, 2)\n    for i = 1, numAsteroids do\n        generator:createEmptyBigAsteroid();\n    end\n\n    local numSmallFields = random:getInt(1, 2)\n    for i = 1, numSmallFields do\n        generator:createEmptySmallAsteroidField()\n    end\n\n    for i = 1, contents.claimableAsteroids do\n        local mat = generator:createAsteroidField()\n        local asteroid = generator:createClaimableAsteroid()\n        asteroid.position = mat\n    end\n\n    OperationExodus.tryGenerateBeacon(generator)\n\n    if random:test(generator:getWormHoleProbability()) then generator:createRandomWormHole() end\n\n    Sector():addScriptOnce(\"data/scripts/sector/eventscheduler.lua\", \"events/pirateattack.lua\")\n    Sector():addScriptOnce(\"data/scripts/sector/background/respawnresourceasteroids.lua\")\n\n    generator:addOffgridAmbientEvents()\n    Placer.resolveIntersections()\nend\n\nreturn SectorTemplate", "domain": "avorion", "metadata": {"context": "server", "avorion_apis": ["Sector", "SectorGenerator", "Placer", "Seed"], "difficulty": "advanced"}}
{"instruction": "How do I create a custom sector template for a shipyard sector in Avorion that spawns in faction territories with defenders, optional repair docks, and travel hubs?", "output": "package.path = package.path .. \";data/scripts/lib/?.lua\"\npackage.path = package.path .. \";data/scripts/?.lua\"\n\nlocal SectorGenerator = include (\"SectorGenerator\")\nlocal Placer = include(\"placer\")\nlocal ShipGenerator = include(\"shipgenerator\")\ninclude(\"music\")\n\nlocal SectorTemplate = {}\n\n-- must be defined, will be used to get the probability of this sector\nfunction SectorTemplate.getProbabilityWeight(x, y, seed, factionIndex, innerArea)\n    if factionIndex then\n        if innerArea then\n            return 200\n        else\n            return 400\n        end\n    else\n        return 0\n    end\nend\n\nfunction SectorTemplate.offgrid(x, y)\n    return false\nend\n\n-- this function returns whether or not a sector should have space gates\nfunction SectorTemplate.gates(x, y)\n    return makeFastHash(x, y, 1) % 3 == 0\nend\n\n-- this function returns what relevant contents there will be in the sector (exact)\nfunction SectorTemplate.contents(x, y)\n    local seed = Seed(string.join({GameSeed(), x, y, \"loneshipyard\"}, \"-\"))\n    math.randomseed(seed);\n\n    local random = random()\n\n    local contents = {ships = 0, stations = 0, seed = tostring(seed)}\n\n    local defendersFactor\n    if Galaxy():isCentralFactionArea(x, y) then\n        defendersFactor = 1.5\n    else\n        defendersFactor = 0.75\n\n        if random:test(0.05) then\n            contents.travelHubs = 1\n        end\n    end\n\n    contents.defenders = round(random:getInt(1, 3) * defendersFactor)\n    contents.ships = contents.defenders\n    contents.repairDocks = random:getInt(0, 1)\n    contents.shipyards = 1\n    contents.stations = contents.shipyards + contents.repairDocks + (contents.travelHubs or 0)\n\n    contents.resourceAsteroids = random:getInt(0, 2)\n    local maximum = random:getInt(0, 1)\n    contents.claimableAsteroids = random:multitest(maximum, 0.33)\n\n    local generator = SectorGenerator(x, y)\n    contents.asteroidEstimation = generator:estimateAsteroidNumbers(2 + contents.resourceAsteroids + contents.claimableAsteroids, 3.5)\n\n    return contents, random\nend\n\nfunction SectorTemplate.musicTracks()\n    local good = {\n        primary = TrackCollection.HappyNeutral(),\n        secondary = combine(TrackCollection.Happy(), TrackCollection.Neutral()),\n    }\n\n    local neutral = {\n        primary = TrackCollection.Neutral(),\n        secondary = TrackCollection.All(),\n    }\n\n    local bad = {\n        primary = combine(TrackCollection.Middle(), TrackCollection.Desolate()),\n        secondary = TrackCollection.Neutral(),\n    }\n\n    return good, neutral, bad\nend\n\n-- player is the player who triggered the creation of the sector (only set in start sector, otherwise nil)\nfunction SectorTemplate.generate(player, seed, x, y)\n    local contents, random = SectorTemplate.contents(x, y)\n\n    local generator = SectorGenerator(x, y)\n\n    local faction = Galaxy():getLocalFaction(x, y) or Galaxy():getNearestFaction(x, y)\n\n    -- create a shipyard station\n    generator:createShipyard(faction);\n\n    if contents.travelHubs then\n        generator:createTravelHub(faction);\n    end\n\n    for i = 1, contents.repairDocks do\n        generator:createRepairDock(faction);\n    end\n\n    -- maybe create some asteroids\n    local numFields = random:getInt(0, 4)\n    for i = 1, numFields do\n        generator:createAsteroidField();\n    end\n\n    for i = 1, contents.resourceAsteroids do\n        local position = generator:createAsteroidField()\n        generator:createBigAsteroid(position)\n    end\n\n    -- create ships\n    for i = 1, contents.defenders do\n        ShipGenerator.createDefender(faction, generator:getPositionInSector())\n    end\n\n    local numSmallFields = random:getInt(2, 5)\n    for i = 1, numSmallFields do\n        generator:createSmallAsteroidField()\n    end\n\n    for i = 1, contents.claimableAsteroids do\n        local mat = generator:createAsteroidField()\n        local asteroid = generator:createClaimableAsteroid()\n        asteroid.position = mat\n    end\n\n    if SectorTemplate.gates(x, y) then generator:createGates() end\n\n    if random:test(generator:getWormHoleProbability()) then generator:createRandomWormHole() end\n\n    Sector():addScriptOnce(\"data/scripts/sector/eventscheduler.lua\", \"events/pirateattack.lua\")\n\n    generator:addAmbientEvents()\n    Placer.resolveIntersections()\nend\n\n-- called by respawndefenders.lua\nfunction SectorTemplate.getDefenders(contents, seed, x, y)\n    local faction = Galaxy():getLocalFaction(x, y) or Galaxy():getNearestFaction(x, y)\n    return faction.index, contents.defenders\nend\n\nreturn SectorTemplate", "domain": "avorion", "metadata": {"context": "server", "avorion_apis": ["Sector", "Galaxy", "SectorGenerator", "ShipGenerator", "Placer"], "difficulty": "advanced"}}
